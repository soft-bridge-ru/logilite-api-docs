## Описание API интеграции с АБ Логистик v25.8.1
Дата обновления: 31.07.2025

---
## **1. Общие параметры HTTP-запроса**

| Параметр      | Значение                        |
| ------------- | ------------------------------- |
| **Метод**     | `POST`                          |
| **URL**       | `https://tsd.logilite.ru/robot` |
| **Endpoint**  | `/hs/out/putdata`               |
| **Формат**    | `application/json`              |
| **Кодировка** | UTF-8                           |

---

## **2. Структура запроса (верхний уровень)**

```json
{
  "User": "string",
  "Password": "string",
  "NameBase": "string",
  "Object": "string",
  "Data": { ... }
}
```

### **Пояснения к полям:**

| Поле       | Тип    | Описание                                                | Обязательное | Рекомендации                         |
| ---------- | ------ | ------------------------------------------------------- | ------------ | ------------------------------------ |
| `User`     | Строка | Логин пользователя в системе АБ Логистик                | Да           | Указано АБ Логистиком                |
| `Password` | Строка | Пароль                                                  | Да           | Указано АБ Логистиком                |
| `NameBase` | Строка | Имя информационной базы клиента (например, `gf`, `mmz`) | Да           | Должно совпадать с учётной записью   |
| `Object`   | Строка | **GUID документа (Ссылка)**                             | Да           | **Должен совпадать с `Data.Ссылка`** |
| `Data`     | Объект | Данные документа (в формате JSON)                       | Да           |                                      |

---

## **3. Структура объекта `Data` — Заказ на реализацию (Торг-12)**

```json
"Data": {
  "Номер": "string",
  "Дата": "datetime",
  "Проведен": "boolean",
  "ПометкаУдаления": "boolean",
  "НомерНакладной": "string",
  "ИДНакладной": "guid",
  "Ссылка": "guid",
  "Тип": "string",
  "ДатаОтгрузки": "datetime",
  "ЦенаВключаетНДС": "boolean",
  "ШтрихКодНакладной": "string",
  "Организация": { ... },
  "Контрагент": { ... },
  "Партнер": { ... },
  "Склад": { ... },
  "Комментарий": "string",
  "АдресДоставки": { ... },
  "Товары": [ ... ]
}
```

### **Обязательные поля `Data`**

| Поле | Тип | Описание | Пример |
|------|-----|----------|-------|
| `Номер` | Строка (11) | Номер документа | `"0000-000016"` |
| `Дата` | ISO 8601 | Дата создания | `"2025-05-17T14:43:01"` |
| `Проведен` | Булево | Признак проведения | `true` |
| `ПометкаУдаления` | Булево | Признак удаления | `false` |
| `НомерНакладной` | Строка (11) | Номер ТОРГ-12 | Может быть пустым |
| `ИДНакладной` | GUID | Уникальный ID накладной | Может быть пустым |
| `Ссылка` | GUID | Уникальный ID документа | Обязателен |
| `Тип` | Строка | `"ДокументСсылка.Order"` | Только для реализации |
| `ДатаОтгрузки` | ISO 8601 | Требуемая дата отгрузки | `"2025-05-17T14:43:01"` |
| `ЦенаВключаетНДС` | Булево | Включена ли НДС в цену | `true`/`false` |
| `ШтрихКодНакладной` | Строка | Штрихкод документа | `""` — если нет |

---

## **4. Вложенные объекты**

### **4.1. Организация (продавец)**

| Поле | Тип | Описание | Обязательное |
|------|-----|----------|--------------|
| `Наименование` | Строка | Полное наименование | Да |
| `ИНН` | Строка | ИНН организации | Да |
| `КПП` | Строка | КПП организации | Да |

---

### **4.2. Контрагент (покупатель)**

| Поле | Тип | Описание | Обязательное |
|------|-----|----------|--------------|
| `Наименование` | Строка | Краткое наименование | Да |
| `НаименованиеПолное` | Строка | Полное наименование (рекомендуется) | Рекомендуется |
| `ИНН` | Строка | ИНН контрагента | Да |
| `КПП` | Строка | КПП контрагента | Да |
| `Guid_Контрагента` | GUID | Уникальный идентификатор | Рекомендуется |
| `ФактическийАдрес` | Строка | Фактический адрес | Опционально |
| `ЮридическийАдрес` | Строка | Юридический адрес | Опционально |

---

### **4.3. Партнер**

> Может отличаться от контрагента (например, дистрибьютор)

| Поле | Тип | Описание | Обязательное |
|------|-----|----------|--------------|
| `Guid` | GUID | Уникальный идентификатор | Рекомендуется |
| `Наименование` | Строка | Наименование партнера | Рекомендуется |
| `НаименованиеПолное` | Строка | Полное наименование | Рекомендуется |

---

### **4.4. Склад (отгрузки)**

| Поле | Тип | Описание | Обязательное |
|------|-----|----------|--------------|
| `Наименование` | Строка | Название склада | Да |
| `ИД` | GUID | Уникальный идентификатор склада | Да |

---

### **4.5. АдресДоставки**

| Поле            | Тип           | Описание                                | Обязательное       |
| --------------- | ------------- | --------------------------------------- | ------------------ |
| `Представление` | Строка        | Полный адрес в текстовом виде           | Да                 |
| `ЗначенияПолей` | Строка (JSON) | Структурированный адрес (рекомендуется) | Рекомендуется      |


> ✅ Пример `ЗначенияПолей`:
> ```json
> "{\"version\":4,\"value\":\"141426, Московская область, г. Химки, ш. Шереметьевское, владение 31\",\"type\":\"Адрес\",\"country\":\"Россия\",\"addressType\":\"ВСвободнойФорме\"}"
> ```

---

## **5. Массив `Товары`**

Каждый элемент — объект с информацией о товаре.

```json
{
  "Номенклатура": { ... },
  "Упаковка": "string",
  "Партия": { ... },
  "Количество": "number",
  "Цена": "number",
  "Сумма": "number",
  "СуммаНДС": "number",
  "СтавкаНДС": "string",
  "numberGTD": "string",
  "countryGTD": "string",
  "РеестраКачества": { ... }
}
```

---

### **5.1. Объект `Номенклатура`**

| Поле | Тип | Описание | Обязательное |
|------|-----|----------|--------------|
| `Наименование` | Строка (100) | Наименование товара | Да |
| `Код` | Строка (11) | Код номенклатуры | Да |
| `Артикул` | Строка (50) | Артикул | Да (может быть пустым) |
| `ИД` | GUID | Уникальный идентификатор товара | Да |
| `ЕдиницаИзмерения` | Объект | Единица измерения | Да |
| `СтавкаНДС` | Строка | Ставка НДС: `"10%"`, `"20%"`, `"Без НДС"` | Да |
| `ВесЧислитель` | Число (15,3) | Вес числителя (например, 1 кг) | Да |
| `ВесЗнаменатель` | Число (15,3) | Вес знаменателя (например, 1 шт) | Да |
| `ШК` | Массив строк | Штрихкоды товара | Да |

#### **ЕдиницаИзмерения**
| Поле | Тип | Описание |
|------|-----|----------|
| `Наименование` | Строка | `"кг"`, `"шт"` |
| `Код` | Строка | Код по ОКЕИ, напр. `"166 "` (кг), `"796 "` (шт) |

---

### **5.2. Поле `Упаковка`**

| Поле       | Тип    | Описание                   | Обязательное |
| ---------- | ------ | -------------------------- | ------------ |
| `Упаковка` | Строка | Описание упаковки или `""` | Нет          |

---

### **5.3. Объект `Партия`**

> Передаётся, если ведётся учёт по партиям (молочка, скоропорт)

| Поле | Тип | Описание | Обязательное |
|------|-----|----------|--------------|
| `УчетПоПартиям` | Булево | Признак учёта | Да |
| `ДатаПроизводства` | ISO 8601 | Дата производства | Да (если есть партия) |
| `ДатаСрокГодности` | ISO 8601 | Срок годности | Да |
| `Партия` | Строка | Номер партии | Да |
| `Производитель` | Строка | Производитель | Да |
| `Guid` | GUID | Уникальный ID партии | Да |

---

### **5.4. Объект `РеестраКачества`**

> Обязателен для пищевой продукции

| Поле | Тип | Описание |
|------|-----|----------|
| `ДокументСоответствия` | Строка | Номер декларации |
| `ДатаВыдачи` | ISO 8601 | Дата выдачи |
| `Изготовитель` | Строка | Производитель |
| `ДатаОкончания` | ISO 8601 | Дата окончания действия |
| `Ответственный` | Строка | Ответственное лицо |
| `ОрганРегистрации` | Строка | Орган, выдавший документ |
| `ШтрихКод` | Строка | Штрихкод товара (дублирует один из `ШК`) |

---

## **6. Правила формирования `Object`**

Поле `Object` **должно содержать значение `Data.Ссылка`**.

✅ Пример:
```json
"Data": {
  "Ссылка": "bfca37da-0eea-11f0-bcbf-000c2981c721"
},
"Object": "bfca37da-0eea-11f0-bcbf-000c2981c721"
```

> Это позволяет системе АБ Логистик коррелировать запросы и избежать дублей.

---

## **7. Итоговый пример (шаблон)**

```json
{
  "User": "user1",
  "Password": "SomeSecretPass",
  "NameBase": "baze1",
  "Object": "9a1043f5-6d3c-11f0-bce0-bc2411b4a333", // = Data.Ссылка
  "Data": {
    "Номер": "0000-019125",
    "Дата": "2025-07-30T14:59:16",
    "Проведен": true,
    "ПометкаУдаления": false,
    "НомерНакладной": "", // может быть пустым
    "ИДНакладной": "", // может быть пустым
    "Ссылка": "9a1043f5-6d3c-11f0-bce0-bc2411b4a333",
    "Тип": "ДокументСсылка.Order",
    "ДатаОтгрузки": "2025-08-04T00:00:00",
    "ЦенаВключаетНДС": true,
    "ШтрихКодНакладной": "",
    "Организация": {
      "Наименование": "Минский молочный завод №1",
      "ИНН": "7816556331",
      "КПП": "781401001"
    },
    "Контрагент": {
      "Наименование": "СТИМУЛ ",
      "НаименованиеПолное": "ООО \"СТИМУЛ\"",
      "ИНН": "6319264190",
      "КПП": "631901001",
      "Guid_Контрагента": "eda86fd8-6474-11ef-91f9-ac1f6bec65db"
    },
    "Партнер": {
      "Guid": "eda86fd8-6474-11ef-91f9-ac1f6bec65db",
      "Наименование": "СТИМУЛ ",
      "НаименованиеПолное": "СТИМУЛ ООО"
    },
    "Склад": {
      "Наименование": "Фуд логистик",
      "ИД": "d953c480-7030-11ef-91f9-ac1f6bec65db"
    },
    "Комментарий": "СЫР\nЗаказ ООО \"СТИМУЛ\" 443022, Самарская область, г Самара, проезд Мальцева, д. 4, корп. 20",
    "АдресДоставки": {
      "Представление": "443022, Самарская область, г Самара, проезд Мальцева, д. 4, корп. 20",
      "ЗначенияПолей": "{\"version\":4,\"value\":\"443022, Самарская область, г Самара, проезд Мальцева, д. 4, корп. 20\",\"type\":\"Адрес\",\"country\":\"Россия\",\"addressType\":\"ВСвободнойФорме\"}"
    }, // строка JSON
    "Товары": [
      {
        "Номенклатура": {
          "Наименование": "Сыр \"Белорусское золото\" 45,0% ж. брус вес ",
          "Код": "00-00000033",
          "Артикул": "22210",
          "ИД": "c7318962-0fd5-11ed-91e1-ac1f6bec65db",
          "ЕдиницаИзмерения": {
            "Наименование": "кг",
            "Код": "166 "
          },
          "СтавкаНДС": "10%",
          "ВесЧислитель": 1,
          "ВесЗнаменатель": 1,
          "ШК": ["4811196011208"]
        },
        "Упаковка": "",
        "Партия": {
          "УчетПоПартиям": true,
          "ДатаПроизводства": "2025-04-29T00:00:00",
          "ДатаСрокГодности": "2025-10-26T00:00:00",
          "Партия": "30-03-2",
          "Производитель": "ООО \"Сырный мир\"",
          "Guid": "c65f87f2-2634-11f0-bcdd-bc2411b4a333"
        },
        "Количество": 60,
        "Цена": 579,
        "Сумма": 34740,
        "СуммаНДС": 3158.18,
        "СтавкаНДС": "10%",
        "numberGTD": "",
        "countryGTD": "",
        "РеестраКачества": {
          "ДокументСоответствия": "Декларация №ЕАЭС N RU Д-RU.РА06.В.50661/23",
          "ДатаВыдачи": "2023-08-16T00:00:00",
          "Изготовитель": "ООО \"Еланский сыродельный комбинат\"",
          "ДатаОкончания": "2026-08-15T00:00:00",
          "Ответственный": "Захаров А.И.",
          "ОрганРегистрации": "Тульская испытательная лаборатория",
          "ШтрихКод": "4811196011208"
        }
      }
    ]
  }
}
```

---

## ✅ **Рекомендации по реализации**

1. **`РеестраКачества` — обязателен для пищевой продукции.**
2. **`Партия` — обязателен, если есть сроки годности.**
3. **`ЗначенияПолей` — передавать как строку JSON, если возможно.**
